<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IoT Demo Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  body {
    font-family: "Segoe UI", Arial, sans-serif;
    background: #f7f9fc;
    margin: 0;
    padding: 0;
    color: #333;
  }

  h2 {
    margin-top: 0;
  }

  .dashboard {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    padding: 30px;
    gap: 25px;
  }

  .card {
    background: #fff;
    border-radius: 16px;
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
    padding: 25px;
    width: 360px;
  }

  .device-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 12px;
  }

  .device-icon {
    background: #007bff;
    color: white;
    font-weight: bold;
    border-radius: 50%;
    width: 44px;
    height: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .big-temp {
    font-size: 48px;
    font-weight: bold;
    color: #ff6b6b;
  }

  .humidity {
    font-size: 22px;
    color: #007bff;
  }

  .meta {
    font-size: 13px;
    color: #666;
    margin-bottom: 10px;
  }

  .controls {
    display: flex;
    gap: 10px;
    margin-top: 10px;
  }

  button {
    padding: 8px 14px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-weight: 500;
  }

  .primary { background: #007bff; color: white; }
  .warn { background: #ff6b6b; color: white; }
  .gray { background: #ddd; }

  .chart-card {
    background: #fff;
    border-radius: 16px;
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
    padding: 25px;
    width: 700px;
  }

  canvas {
    width: 100%;
    height: 340px;
  }

  .footer {
    text-align: center;
    padding: 20px;
    color: #888;
    font-size: 14px;
  }
</style>
</head>
<body>

<div class="dashboard">
  <div class="card">
    <div class="device-header">
      <div class="device-icon">IoT</div>
      <div>
        <strong>Demo Device • Living Room</strong><br>
        <span class="meta">Device ID: demo-123 • Connected: <span style="color:green">Yes</span></span>
      </div>
    </div>

    <div class="big-temp" id="temp">-- °C</div>
    <div class="humidity" id="hum">-- %</div>
    <div class="meta">Last update: <span id="time">--</span></div>

    <div class="controls">
      <button class="primary" id="start">Start Data</button>
      <button class="gray" id="clear">Clear</button>
      <button class="warn" id="cmd">Send Command</button>
    </div>

    <div class="meta" style="margin-top:10px;">Mode: Simulated</div>
  </div>

  <div class="chart-card">
    <h2>Live Temperature & Humidity</h2>
    <canvas id="chart"></canvas>
  </div>
</div>

<div class="footer">
  IoT Demo Dashboard • Simulated Device Data
</div>

<script>
const ctx = document.getElementById("chart").getContext("2d");
const data = {
  labels: [],
  datasets: [
    { label: "Temperature (°C)", data: [], borderColor: "#ff6b6b", fill: false, tension: 0.3 },
    { label: "Humidity (%)", data: [], borderColor: "#007bff", fill: false, tension: 0.3 }
  ]
};

const chart = new Chart(ctx, {
  type: "line",
  data,
  options: {
    responsive: true,
    animation: false,
    scales: {
      x: { ticks: { color: "#555" } },
      y: { beginAtZero: false, ticks: { color: "#555" } }
    },
    plugins: {
      legend: { display: true, labels: { color: "#333" } }
    }
  }
});

let running = false;
let timer = null;
const tempEl = document.getElementById("temp");
const humEl = document.getElementById("hum");
const timeEl = document.getElementById("time");

function randomValue(base, range) {
  return (base + (Math.random() * range - range / 2)).toFixed(1);
}

function addReading() {
  const now = new Date();
  const label = now.toLocaleTimeString();
  const t = parseFloat(randomValue(25, 3));
  const h = parseFloat(randomValue(50, 8));

  if (data.labels.length >= 30) {
    data.labels.shift();
    data.datasets[0].data.shift();
    data.datasets[1].data.shift();
  }

  data.labels.push(label);
  data.datasets[0].data.push(t);
  data.datasets[1].data.push(h);
  chart.update();

  tempEl.textContent = `${t} °C`;
  humEl.textContent = `${h} %`;
  timeEl.textContent = label;
}

function startSimulation() {
  if (running) return;
  running = true;
  timer = setInterval(addReading, 1000);
}

function stopSimulation() {
  running = false;
  clearInterval(timer);
}

document.getElementById("start").addEventListener("click", () => {
  if (running) {
    stopSimulation();
    document.getElementById("start").textContent = "Start Data";
  } else {
    startSimulation();
    document.getElementById("start").textContent = "Stop Data";
  }
});

document.getElementById("clear").addEventListener("click", () => {
  data.labels = [];
  data.datasets[0].data = [];
  data.datasets[1].data = [];
  chart.update();
  tempEl.textContent = "-- °C";
  humEl.textContent = "-- %";
  timeEl.textContent = "--";
});

document.getElementById("cmd").addEventListener("click", () => {
  alert("Command sent to simulated device!");
});

startSimulation();
</script>
</body>
</html>
